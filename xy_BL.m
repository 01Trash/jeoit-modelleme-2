% HRT432 Geoid Modellig, Kocaeli University, Geodesy Division, Turkey
% O.KURT, orhan.kurt@kocaeli.edu.tr
% An octave subroutine for (x,y-50000.,L0) ---> (B,L)
function [ B , L ] = xy_BL(a,b,L0,x,y);
   bn = (a-b)/(a+b) ;
   b1 = (a+b)/2.*(1.+ bn^2/4. + bn^4/64.);
   b2 = 3./2.*bn       -27./ 32.*bn^3 + 269./512.*bn^5; 
   b3 = 21./16.*bn^2   -55./ 32.*bn^4;
   b4 = 151./96.*bn^3 +417./128.*bn^5;
   b5 = 1097./512.* bn^4;
   B0 = (x/b1)+b2*sin(2.*x/b1)+b3*sin(4.*x/b1)+b4*sin(6.*x/b1)+b5*sin(8.*x/b1); 
   t  = tan(B0); 
   nu = (a^2-b^2)*(cos(B0)/b)^2 ;
   N  = a^2/b/sqrt(1.+nu) ;
   B = (B0 ...
      + t/2.*(y/N)^2.*(-1.-nu)...
      + t/24.*(y/N)^4.*(5.+3.*t*t+6.*nu-6.*t*t*nu-3.*nu*nu-9.*t*t*nu*nu) ...
      + t/720.*(y/N)^6.*(-61.-90.*t*t-45.*t^4 ...
      - 107.*nu+162.*t*t*nu+45.*(t^4.)*nu) ...
      + t/40320.*(y/N)^8.*(1385.+3633.*t*t+4095.*t^4.+1575.*t^6.));

   L =(L0  ...
      +  y/N/cos(B0) ...
      + (y/N)^3./6./cos(B0)*(-1.-2.*t*t-nu) ...
      + (y/N)^5./120./cos(B0)*(5.+28.*t*t+24.*t^4.+6.*nu+8.*t*t*nu) ...
      + (y/N)^7./5040./cos(B0)*(-61.-662.*t*t-1320.*t^4.-720.*t^6.));

endfunction